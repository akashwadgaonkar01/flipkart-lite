import{r as l,o as w,p as L,q as R,s as A,B as y,j as e,k as U}from"./index-3a18405f.js";import{u as H,c as _,a as u}from"./index.esm-c67c8b3d.js";import{C as B}from"./Container-9f84d73e.js";import{S as D}from"./Spinner-1ef812e2.js";import{C as j}from"./Card-fb741296.js";import{F as m}from"./FormControl-5ba357e7.js";import{B as d}from"./Button-1f7a4a3f.js";import"./ThemeProvider-ba5d72ab.js";import"./CardHeaderContext-7d80cc6b.js";import"./index-6d5b65dd.js";import"./Button-d4d17781.js";const X=()=>{const[N,f]=l.useState(!1),[i,h]=l.useState([]),[C,p]=l.useState([]),{data:g}=w(),[F,{isSuccess:P,isLoading:S}]=L(),[v,{isSuccess:b,isLoading:E}]=R(),[k,{isSuccess:I,isLoading:q}]=A(),[s,x]=l.useState(),a=H({enableReinitialize:!0,initialValues:{name:s?s.name:"",desc:s?s.desc:"",price:s?s.price:"",qty:s?s.qty:"",hero:s?s.hero:""},validationSchema:_({name:u().required("Enter name"),desc:u().required("Enter desc"),price:u().required("Enter price"),qty:u().required("Enter qty")}),onSubmit:(r,{resetForm:t})=>{if(s){const c=new FormData;for(const n in r)n!=="hero"&&c.append(n,r[n]);for(const n of i)c.append("remove",n);for(const n of r.hero)c.append("hero",n);k({_id:s._id,fd:c}),x(null),h([])}else{const c=new FormData;for(const n in r)n!=="hero"&&c.append(n,r[n]);for(const n of r.hero)c.append("hero",n);v(c)}p([]),t()}}),o=r=>U({"form-control my-2":!0,"is-invalid":a.touched[r]&&a.errors[r],"is-valid":a.touched[r]&&!a.errors[r]});return l.useEffect(()=>{b&&y.success("product create success")},[b]),l.useEffect(()=>{P&&y.success("product delete success")},[P]),e.jsxs(B,{children:[E||S||q?e.jsxs(e.Fragment,{children:["Please Wait ... ",e.jsx(D,{})," "]}):e.jsxs(j,{className:"mb-5",children:[e.jsx(j.Header,{children:"Product"}),e.jsx(j.Body,{children:e.jsxs("form",{onSubmit:a.handleSubmit,children:[e.jsx(m,{className:o("name"),placeholder:"Enter Product Name",...a.getFieldProps("name")}),e.jsx(m,{className:o("desc"),placeholder:"Enter Product Description",...a.getFieldProps("desc")}),e.jsx(m,{type:"number",className:o("price"),placeholder:"Enter Product Price",...a.getFieldProps("price")}),e.jsx(m,{type:"number",className:o("qty"),placeholder:"Enter Product Qty",...a.getFieldProps("qty")}),s?e.jsxs(e.Fragment,{children:[s.hero.map(r=>e.jsx("div",{children:e.jsxs("div",{className:`${i.includes(r)&&"border border-danger my-2"} d-flex justify-content-between align-items-center px-4`,children:[e.jsx("img",{src:r,height:100,className:"me-2 rounded-3",alt:""}),i.includes(r)?e.jsx(d,{onClick:t=>h(i.filter(c=>r!==c)),variant:"dark",children:"cancel"}):e.jsx(d,{variant:"danger",onClick:t=>{i.includes(r)||h([...i,r])},children:"Remove"})]},r._id)})),N?e.jsxs(e.Fragment,{children:[e.jsx(m,{type:"file",multiple:!0,onChange:r=>{const t=[];for(const c of r.target.files)t.push(URL.createObjectURL(c));p(t),a.setFieldValue("hero",r.target.files)},className:o("hero"),placeholder:"Enter Product Hero"}),e.jsx(d,{onClick:r=>f(!1),variant:"dark",children:"cancel"})]}):e.jsx(d,{onClick:r=>f(!0),className:"my-3",children:"Add New Image"})]}):e.jsx(e.Fragment,{children:e.jsx(m,{type:"file",multiple:!0,onChange:r=>{const t=[];for(const c of r.target.files)t.push(URL.createObjectURL(c));a.setFieldValue("hero",r.target.files),p(t)},className:o("hero"),placeholder:"Enter Product Hero"})}),C.map(r=>e.jsx("img",{src:r,height:50,alt:""})),s?e.jsxs(e.Fragment,{children:[e.jsx(d,{type:"submit",variant:"warning",className:"w-100 btn-lg",children:"Update Product"}),e.jsx(d,{type:"button",onClick:r=>x(null),variant:"outline-dark",className:"w-100 btn-lg mt-3",children:"Cancel"})]}):e.jsx(d,{type:"submit",className:"w-100 btn-lg",children:"Add Product"})]})})]}),e.jsxs("table",{className:"table table-dark table-striped table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"name"}),e.jsx("th",{children:"desc"}),e.jsx("th",{children:"price"}),e.jsx("th",{children:"qty"}),e.jsx("th",{children:"hero"}),e.jsx("th",{children:"actions"})]})}),e.jsx("tbody",{children:g&&g.result.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:r.name}),e.jsx("td",{children:r.desc}),e.jsx("td",{children:r.price}),e.jsx("td",{children:r.qty}),e.jsx("td",{children:r.hero.map(t=>e.jsx("img",{src:t,height:50,className:"mx-2 rounded-2",alt:""},t))}),e.jsxs("td",{children:[e.jsx(d,{onClick:t=>x(r),className:"me-2",variant:"warning",children:"Edit"}),e.jsx(d,{className:"me-2",variant:"danger",onClick:t=>F(r._id),children:"Remove"})]})]},r._id))})]})]})};export{X as default};
